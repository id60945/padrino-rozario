## FAQ

### Куда прописывается основной домен помимо конфигурации Nginx?
/srv/rozarioflowers.ru/app/app.rb -> CURRENT_DOMAIN
/srv/rozarioflowers.ru/app/controllers/user_accounts.rb -> CURRENT_DOMAIN
PS. На данный моменнт это тоже необходимое зло для борьбы с legacy. Техническим долгом остаётся достижение доменной независимости. Однако приложение изначально рассчитано на работу с доменами третьего уровня.

### Для чего нужна директория `/var/www/rozarioflowers.ru`?
До конца не известно. Это старое legacy-расположение, в которое добавлена символическая ссылка с /srv/rozarioflowers.ru на /var/www/rozarioflowers.ru/rozario для обратной совместимости. Многие файлы бэкенда ссылаются именно на это расположение и её родительскую директорию. Впоследствии необходимо разрешить устаревшие пути на основную директорию приложения /srv/rozarioflowers.ru, перенести туда необходимые файлы и удалить неиспользуемое legacy.

### Куда подевались исходники новой корзины на Vue?
Никто не знает.

## SideKiq

SideKiq — это библиотека для языка программирования Ruby, предназначенная для обработки фоновых задач и асинхронных процессов. В данном контексте: генерирует файлы `sitemap.xml` и `robots.txt` (для каждого субдомена отдельно).

Описание задач хранится в папке `workers` в корневой директории проекта.

Панель администратора SideKiq живёт по адресу https://rozarioflowers.ru/admin/sidekiq. Доступ панели контролируется через конфигурацию Nginx посредством базовой аутентификации (auth_basic).

Для создания нового пользователя используйте: `sudo htpasswd -c /etc/nginx/.htpasswd [username]`. Параметр `-c` используется только для создания нового файла. Если файл уже существует, его не следует использовать с этим параметром, чтобы не перезаписать его. Вас попросят ввести и подтвердить пароль для пользователя `username`.

Также убедитесь, что файл `.htpasswd` имеет правильные права доступа и не доступен для чтения другими пользователями. Например:
```bash
sudo chmod 640 /etc/nginx/.htpasswd
sudo chown root:nginx /etc/nginx/.htpasswd
```

## hygiene.sh

Данный скрипт предназначен для рекурсивного поиска и исправления файлов в кодировках несовместимых с UTF-8. А также для установки и исправления заголовков кодировки для файлов `.rb` и `.haml`. В общем плане в данный скрипт следует внедрять все необходимые процедуры для удаления мусора и поддрержания чистоты кода.